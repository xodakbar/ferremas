{# templates/carrito/_contenido_carrito.html #}
{% load custom_filters humanize %}

{% if items %}
<div class="px-3 py-2 space-y-2">
  {# —— Ítems del carrito —— #}
  {% for item in items %}
  <div class="flex items-center justify-between py-2 border-b border-gray-200">
    <div class="flex items-center space-x-2">
      {% if item.producto.imagen %}
      <img src="{{ item.producto.imagen.url }}"
           alt="{{ item.producto.nombre }}"
           class="w-10 h-10 object-cover rounded-sm" />
      {% endif %}
      <div class="flex flex-col">
        <span class="text-sm font-medium text-gray-800">{{ item.producto.nombre }}</span>
        <span class="mt-1 inline-block text-xs bg-gray-200 text-gray-700 px-2 py-0.5 rounded-md">
          Cantidad: {{ item.cantidad }}
        </span>
      </div>
    </div>
    <span class="text-sm font-semibold text-green-600">
      ${{ item.cantidad|multiply:item.producto.precio|floatformat:0|intcomma }}
    </span>
  </div>
  {% endfor %}

  {# —— Línea de total —— #}
  <div class="pt-2 border-t border-gray-200 flex justify-between items-center text-sm font-medium">
    <span>Total:</span>
    <span>${{ total|floatformat:0|intcomma }}</span>
  </div>

  {# —— Botones —— #}
  <div class="mt-2 flex space-x-2">
    <a href="{% url 'home' %}"
       class="flex-1 text-center text-xs px-2 py-1 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100">
      Seguir comprando
    </a>
    <form action="{% url 'procesar_pago' carrito.id %}" method="post" class="flex-1">
      {% csrf_token %}
      <button type="submit"
              class="w-full text-center text-xs px-2 py-1 bg-green-600 text-white rounded-md hover:bg-green-700">
        Pagar WebPay
      </button>
    </form>
  </div>
</div>

{% else %}
<div class="flex flex-col items-center justify-center py-8 space-y-2">
  <i class="bi bi-cart-x text-gray-300 text-4xl"></i>
  <p class="text-sm text-gray-600">Tu carrito está vacío</p>
  <a href="{% url 'home' %}"
     class="text-xs px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700">
    Explorar
  </a>
</div>
{% endif %}
